{
  "findings": [
    {"id": "IA-01", "category": "implementation", "impact": "critical", "title": "Repository Purpose and Scope", "summary": "This is a developer tools utility repository, not an application with authentication infrastructure", "node_id": null, "references": ["CLAUDE.md:1-57", "README.md:1-45"]},
    {"id": "IA-02", "category": "implementation", "impact": "low", "title": "CLI Tool Authentication References", "summary": "References to user-initiated authentication flows for third-party CLIs (OpenCode, Claude, Codex)", "node_id": null, "references": ["install/install-coding-stuff.sh:404", "install/install-coding-stuff.sh:504"]},
    {"id": "IA-03", "category": "implementation", "impact": "medium", "title": "API Key Configuration References", "summary": "Configuration placeholders for external API keys (Perplexity, OpenRouter) used by MCP servers", "node_id": null, "references": [".env.sample:3-4", "agents/mcp/servers.json:11-12"]},
    {"id": "IA-04", "category": "implementation", "impact": "low", "title": "Permission and Session Management", "summary": "Bash helper for sudo permissions during installation - shell session state, not auth sessions", "node_id": null, "references": ["install/lib/permission_helper.sh"]},
    {"id": "IA-05", "category": "documentation", "impact": "low", "title": "Planning Templates Reference Authentication", "summary": "OAuth2 used as example feature in planning workflow documentation", "node_id": null, "references": ["agents/commands/GETTING-STARTED.md:8-45"]},
    {"id": "IA-06", "category": "documentation", "impact": "low", "title": "Agent Task Examples", "summary": "Example task name T007-Implement token refresh in planning documentation", "node_id": null, "references": ["agents/commands/plan-1a-explore.md:131"]},
    {"id": "IA-07", "category": "documentation", "impact": "low", "title": "Architecture Example", "summary": "Hypothetical auth service example in planning command documentation", "node_id": null, "references": ["agents/commands/plan-3-architect.md:142"]},
    {"id": "IA-08", "category": "implementation", "impact": "medium", "title": "MCP Server Configuration", "summary": "Configuration for MCP servers - no auth logic, delegates to external services", "node_id": null, "references": ["agents/mcp/servers.json", "agents/settings.local.json"]},
    {"id": "IA-09", "category": "implementation", "impact": "critical", "title": "Absence of Authentication Infrastructure", "summary": "Zero authentication infrastructure code found in comprehensive search", "node_id": null, "references": ["Repository root"]},
    {"id": "IA-10", "category": "implementation", "impact": "high", "title": "External Authentication Delegation", "summary": "Repository deliberately outsources authentication to external services and CLIs", "node_id": null, "references": ["install/*.sh"]},
    {"id": "DC-01", "category": "dependency", "impact": "high", "title": "Claude Code CLI Authentication", "summary": "Claude Code CLI requires user auth via claude login command", "node_id": null, "references": ["install/claude-code.sh:120"]},
    {"id": "DC-02", "category": "dependency", "impact": "medium", "title": "NPM Global Package Authentication", "summary": "Tools installed via npm may require authentication for private packages", "node_id": null, "references": ["install/claude-code.sh:97-98", "install/opencode.sh:113"]},
    {"id": "DC-03", "category": "dependency", "impact": "high", "title": "MCP Server API Key Configuration", "summary": "Perplexity MCP server requires PERPLEXITY_API_KEY environment variable", "node_id": null, "references": [".env.sample:3-4", "agents/mcp/servers.json:10-12"]},
    {"id": "DC-04", "category": "dependency", "impact": "medium", "title": "OpenRouter LLM Provider Authentication", "summary": "MCP Browser Use depends on MCP_LLM_OPENROUTER_API_KEY", "node_id": null, "references": [".env.sample:7-8"]},
    {"id": "DC-05", "category": "dependency", "impact": "medium", "title": "GitHub Repository Access", "summary": "FlowSpace installed via uvx from GitHub repository", "node_id": null, "references": ["install/fs2.sh:117"]},
    {"id": "DC-06", "category": "dependency", "impact": "medium", "title": "Shell Configuration Authority", "summary": "Setup modifies shell config files with PATH exports", "node_id": null, "references": ["setup_manager.py:68", "setup_manager.py:183-205"]},
    {"id": "DC-07", "category": "dependency", "impact": "high", "title": "Environment Variable Sanitization", "summary": "Filters problematic env vars for subprocess safety", "node_id": null, "references": ["setup_manager.py:94-132"]},
    {"id": "DC-08", "category": "dependency", "impact": "medium", "title": "Sudo Privilege Escalation", "summary": "Permission helper detects errors and prompts for sudo", "node_id": null, "references": ["install/lib/permission_helper.sh:22-65"]},
    {"id": "DC-09", "category": "dependency", "impact": "medium", "title": "MCP Configuration File Dependencies", "summary": "MCP configs define integrations with external services", "node_id": null, "references": ["agents/mcp/servers.json", "install/agents.sh:106-160"]},
    {"id": "DC-10", "category": "dependency", "impact": "medium", "title": "Multi-CLI Coordination", "summary": "System manages commands across Claude, OpenCode, Codex, GH Copilot, VS Code", "node_id": null, "references": ["install/agents.sh:71-88"]},
    {"id": "PS-01", "category": "pattern", "impact": "medium", "title": "Result Object Pattern", "summary": "Uses @dataclass for immutable result objects encapsulating operation outcomes", "node_id": null, "references": ["setup_manager.py:35-45", "install/coding_tools_installer.py:46-56"]},
    {"id": "PS-02", "category": "pattern", "impact": "high", "title": "Permission Helper Pattern", "summary": "Authorization guard validates permissions before elevated execution", "node_id": null, "references": ["install/lib/permission_helper.sh"]},
    {"id": "PS-03", "category": "pattern", "impact": "high", "title": "Clean Environment Pattern", "summary": "Filters dangerous env vars (BASH_ENV, BASH_FUNC_*) for security", "node_id": null, "references": ["setup_manager.py:91-138"]},
    {"id": "PS-04", "category": "pattern", "impact": "medium", "title": "Retry with Escalation Pattern", "summary": "Intelligent retry with permission escalation fallback", "node_id": null, "references": ["install/lib/permission_helper.sh:94-167"]},
    {"id": "PS-05", "category": "pattern", "impact": "medium", "title": "Structured Logging Pattern", "summary": "Multi-level error handling with visual status indicators", "node_id": null, "references": ["setup_manager.py:175-474"]},
    {"id": "PS-06", "category": "pattern", "impact": "medium", "title": "Manager Class Pattern", "summary": "SetupManager encapsulates setup state and configuration", "node_id": null, "references": ["setup_manager.py:48-77"]},
    {"id": "PS-07", "category": "pattern", "impact": "medium", "title": "Configuration Backup Pattern", "summary": "Timestamped backups before modification for rollback capability", "node_id": null, "references": ["install/agents.sh:218-229"]},
    {"id": "PS-08", "category": "pattern", "impact": "medium", "title": "Hierarchical Config Loading", "summary": "Multi-location configuration discovery (project → user → repo)", "node_id": null, "references": ["install/agents.sh:59-70"]},
    {"id": "PS-09", "category": "pattern", "impact": "medium", "title": "Version Tracking Pattern", "summary": "Before/after version comparison for change management", "node_id": null, "references": ["setup_manager.py:268-350"]},
    {"id": "PS-10", "category": "pattern", "impact": "medium", "title": "Subprocess Isolation Pattern", "summary": "Wrapped subprocess execution with timeout handling", "node_id": null, "references": ["install/coding_tools_installer.py:258-298"]},
    {"id": "QT-01", "category": "quality", "impact": "high", "title": "Environment Variable Filtering Tests", "summary": "Tests for BASH_ENV, ENV, BASH_FUNC_* filtering", "node_id": null, "references": ["tests/test_coding_tools_installer.py:97-148"]},
    {"id": "QT-02", "category": "quality", "impact": "medium", "title": "Subprocess Execution Safety Tests", "summary": "Tests for command execution, failure handling, exit code validation", "node_id": null, "references": ["tests/test_coding_tools_installer.py:150-196"]},
    {"id": "QT-03", "category": "quality", "impact": "high", "title": "BASH_ENV Vulnerability Mitigation", "summary": "Manual security test demonstrating BASH_ENV exploitation prevention", "node_id": null, "references": ["test-bash-env-fix.py"]},
    {"id": "QT-04", "category": "quality", "impact": "medium", "title": "API Key Validation", "summary": "Validates PERPLEXITY_API_KEY is set and not placeholder", "node_id": null, "references": ["install/agents.sh:119-160"]},
    {"id": "QT-05", "category": "quality", "impact": "low", "title": "Version Comparison Testing", "summary": "Semantic version comparison including pre-release and build metadata", "node_id": null, "references": ["tests/test_coding_tools_installer.py:67-95"]},
    {"id": "QT-06", "category": "quality", "impact": "low", "title": "Command Availability Detection", "summary": "Tests for command existence verification", "node_id": null, "references": ["tests/test_coding_tools_installer.py:58-64"]},
    {"id": "QT-07", "category": "quality", "impact": "low", "title": "OS Detection Testing", "summary": "Tests for Linux, macOS, Windows detection", "node_id": null, "references": ["tests/test_coding_tools_installer.py:23-56"]},
    {"id": "QT-08", "category": "quality", "impact": "medium", "title": "Integration Test Coverage", "summary": "Full agents installation flow testing in isolated environment", "node_id": null, "references": ["tests/install/test_agents_copilot_dirs.sh"]},
    {"id": "QT-09", "category": "quality", "impact": "high", "title": "Subprocess Environment Isolation", "summary": "Clean environment creation for secure subprocess execution", "node_id": null, "references": ["install/coding_tools_installer.py:223-256"]},
    {"id": "QT-10", "category": "quality", "impact": "medium", "title": "Test Maturity Assessment", "summary": "22 test methods across 4 files; 82% unit tests", "node_id": null, "references": ["tests/"]},
    {"id": "IC-01", "category": "interface", "impact": "medium", "title": "MCP Server Configuration Schema", "summary": "JSON schema for MCP server definitions", "node_id": null, "references": ["agents/mcp/servers.json"]},
    {"id": "IC-02", "category": "interface", "impact": "medium", "title": "Perplexity API Authentication Contract", "summary": "Environment variable contract for Perplexity API key", "node_id": null, "references": ["agents/mcp/servers.json:11-12"]},
    {"id": "IC-03", "category": "interface", "impact": "medium", "title": "CLI Command Interface Contract", "summary": "ArgumentParser definition for jk-tools-setup", "node_id": null, "references": ["cli.py:14-69"]},
    {"id": "IC-04", "category": "interface", "impact": "medium", "title": "Permission Control Schema", "summary": "Claude CLI permission configuration schema", "node_id": null, "references": [".claude/settings.local.json:2-56"]},
    {"id": "IC-05", "category": "interface", "impact": "medium", "title": "InstallResult Data Contract", "summary": "Dataclass for installation operation results", "node_id": null, "references": ["setup_manager.py:35-46"]},
    {"id": "IC-06", "category": "interface", "impact": "high", "title": "Subprocess Environment Contract", "summary": "Clean environment dictionary filtering specification", "node_id": null, "references": ["install/coding_tools_installer.py:223-256"]},
    {"id": "IC-07", "category": "interface", "impact": "low", "title": "Command Help Interface", "summary": "All tools must support --help flag with structured format", "node_id": null, "references": ["scripts/jk-tools.sh:9-44"]},
    {"id": "IC-08", "category": "interface", "impact": "low", "title": "Alias Generation Convention", "summary": "jk-{alias} naming from dash-separated words", "node_id": null, "references": ["install/aliases.py:34-53"]},
    {"id": "IC-09", "category": "interface", "impact": "medium", "title": "Directory Installation Targets", "summary": "Path specifications for multi-CLI command installation", "node_id": null, "references": ["install/agents.sh:71-88"]},
    {"id": "IC-10", "category": "interface", "impact": "low", "title": "Package Interface", "summary": "PyPI package metadata and entry points", "node_id": null, "references": ["pyproject.toml"]},
    {"id": "DE-01", "category": "documentation", "impact": "high", "title": "Repository Purpose Documentation", "summary": "Clear documentation that this is a tools repo, not an auth system", "node_id": null, "references": ["README.md", "CLAUDE.md"]},
    {"id": "DE-02", "category": "documentation", "impact": "high", "title": "BASH_ENV Security Documentation", "summary": "Implementation and commits documenting BASH_ENV mitigation", "node_id": null, "references": ["setup_manager.py:94-125"]},
    {"id": "DE-03", "category": "documentation", "impact": "medium", "title": "Sudo Permission Handling", "summary": "Documentation of --no-auto-sudo flag for user control", "node_id": null, "references": ["setup_manager.py:308-310"]},
    {"id": "DE-04", "category": "documentation", "impact": "medium", "title": "User-Local npm Installation", "summary": "Documentation of local npm installation to avoid permission issues", "node_id": null, "references": ["Git commits"]},
    {"id": "DE-05", "category": "documentation", "impact": "medium", "title": "Workflow System Sample", "summary": "Authentication research is a sample for workflow orchestrator", "node_id": null, "references": ["enhance/sample/"]},
    {"id": "DE-06", "category": "documentation", "impact": "medium", "title": "Environment Variable Security", "summary": ".env file handling and .gitignore for credentials", "node_id": null, "references": [".gitignore"]},
    {"id": "DE-07", "category": "documentation", "impact": "medium", "title": "ADR Documentation System", "summary": "Architecture Decision Records infrastructure present", "node_id": null, "references": ["docs/adr/README.md"]},
    {"id": "DE-08", "category": "documentation", "impact": "medium", "title": "Constitution & Doctrine", "summary": "System-level constraints before feature work", "node_id": null, "references": ["agents/commands/plan-0-constitution.md"]},
    {"id": "DE-09", "category": "documentation", "impact": "medium", "title": "Code Review Gates", "summary": "Multi-layer code review with security gates", "node_id": null, "references": ["agents/commands/plan-7-code-review.md"]},
    {"id": "DE-10", "category": "documentation", "impact": "medium", "title": "Security Learning in Git History", "summary": "Iterative security maturity shown through commit history", "node_id": null, "references": ["Git log"]},
    {"id": "PL-01", "category": "prior_learning", "impact": "high", "title": "Token Rotation Race Condition", "summary": "Race condition when multiple clients refresh simultaneously; resolved with Redis SETNX", "node_id": null, "references": ["enhance/sample/sample_1/"]},
    {"id": "PL-02", "category": "prior_learning", "impact": "high", "title": "Session Invalidation on Password Change", "summary": "Must invalidate all refresh tokens when user changes password; implemented via token version field", "node_id": null, "references": ["enhance/sample/sample_1/"]}
  ],
  "summary": {
    "total": 52,
    "by_impact": {"critical": 2, "high": 13, "medium": 28, "low": 9},
    "by_category": {"implementation": 10, "dependency": 10, "pattern": 10, "quality": 10, "interface": 10, "documentation": 10, "prior_learning": 2}
  }
}
